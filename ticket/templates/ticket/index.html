{% extends "partials/layout.html" %}
{% block title %}
    {{ title }}
{% endblock %}
{% block content %}
    <div class="m-portlet m-portlet--mobile">
        <div class="m-portlet__head">
            <div class="m-portlet__head-caption">
                <div class="m-portlet__head-title">
                    <h3 class="m-portlet__head-text">
                        لیست فاکتور ها
                    </h3>
                </div>
            </div>
            <div class="m-portlet__head-tools">
                <ul class="m-portlet__nav">
                    {% load has_group %}
                    {% if request.user|has_group:'stylist' %}
                        <li class="m-portlet__nav-item">
                            <a href="/add-sub-factor/"
                               class="btn btn-brand m-btn m-btn--custom m-btn--pill m-btn--icon m-btn--air">
                            <span>
                                <i class="la la-cart-plus"></i>
                                <span>ثبت فاکتور</span>
                            </span>
                            </a>
                        </li>
                    {% elif request.user|has_group:'accountant' %}
                        <li class="m-portlet__nav-item">
                            <a href="/add-user/"
                               class="btn btn-focus m-btn m-btn--custom m-btn--pill m-btn--icon m-btn--air">
                            <span>
                                <i class="la la-cart-plus"></i>
                                <span>ثبت نام مشتری جدید</span>
                            </span>
                            </a>
                        </li>
                    {% else %}
                        <li class="m-portlet__nav-item">
                            <a href="/add-user/"
                               class="btn btn-focus m-btn m-btn--custom m-btn--pill m-btn--icon m-btn--air">
                        <span>
                            <i class="la la-cart-plus"></i>
                            <span>ثبت نام مشتری و پرسنل جدید</span>
                        </span>
                            </a>
                        </li>
                    {% endif %}
                    <li class="m-portlet__nav-item"></li>
                    <li class="m-portlet__nav-item">
                        <div class="m-dropdown m-dropdown--inline m-dropdown--arrow m-dropdown--align-right m-dropdown--align-push"
                             m-dropdown-toggle="hover" aria-expanded="true">
                            <a href="#"
                               class="m-portlet__nav-link btn btn-lg btn-secondary  m-btn m-btn--icon m-btn--icon-only m-btn--pill  m-dropdown__toggle">
                                <i class="la la-ellipsis-h m--font-brand"></i>
                            </a>
                            <div class="m-dropdown__wrapper">
                                <span class="m-dropdown__arrow m-dropdown__arrow--right m-dropdown__arrow--adjust"></span>
                                <div class="m-dropdown__inner">
                                    <div class="m-dropdown__body">
                                        <div class="m-dropdown__content">
                                            <ul class="m-nav">
                                                <li class="m-nav__section m-nav__section--first">
                                                    <span class="m-nav__section-text">لینک های پرکاربرد</span>
                                                </li>
                                                <li class="m-nav__item">
                                                    <a href="/?useful_link=today" class="m-nav__link">
                                                        <i class="m-nav__link-icon flaticon-share"></i>
                                                        <span class="m-nav__link-text">لیست امروز</span>
                                                    </a>
                                                </li>
                                                <li class="m-nav__item">
                                                    <a href="/?useful_link=yesterday" class="m-nav__link">
                                                        <i class="m-nav__link-icon flaticon-share"></i>
                                                        <span class="m-nav__link-text">لیست دیروز</span>
                                                    </a>
                                                </li>
                                                <li class="m-nav__item">
                                                    <a href="/?useful_link=uc" class="m-nav__link">
                                                        <i class="m-nav__link-icon flaticon-chat-1"></i>
                                                        <span class="m-nav__link-text">لیست پرداخت نشده ها</span>
                                                    </a>
                                                </li>
                                                <li class="m-nav__item">
                                                    <a href="/?useful_link=this_week" class="m-nav__link">
                                                        <i class="m-nav__link-icon flaticon-multimedia-2"></i>
                                                        <span class="m-nav__link-text">لیست این هفته</span>
                                                    </a>
                                                </li>
                                                <li class="m-nav__separator m-nav__separator--fit m--hide">
                                                </li>
                                                <li class="m-nav__item m--hide">
                                                    <a href="#"
                                                       class="btn btn-outline-danger m-btn m-btn--pill m-btn--wide btn-sm">Submit</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="m-portlet__body">

            <!--begin: Datatable -->
            <div id="m_table_1_wrapper" class="dataTables_wrapper dt-bootstrap4">
                <div class="row">
                    <div class="col-sm-12">
                        <table class="table table-striped- table-bordered table-hover table-checkable dataTable dtr-inline  table-responsive-sm table-responsive-md"
                               id="m_table_1" role="grid" aria-describedby="m_table_1_info" style="width: 984px;">
                            <thead>
                            <tr role="row">
                                <th class="sorting_asc" tabindex="0" aria-controls="m_table_1" rowspan="1" colspan="1"
                                    style="width: 66.25px;" aria-label="Record ID: activate to sort column descending"
                                    aria-sort="ascending">شماره فاکتور
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="m_table_1" rowspan="1" colspan="1"
                                    style="width: 61.25px;" aria-label="Order ID: activate to sort column ascending">
                                    نام مشتری
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="m_table_1" rowspan="1" colspan="1"
                                    style="width: 57.25px;" aria-label="Country: activate to sort column ascending">
                                    شماره همراه
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="m_table_1" rowspan="1" colspan="1"
                                    style="width: 103.25px;" aria-label="Ship City: activate to sort column ascending">
                                    تاریخ فاکتور
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="m_table_1" rowspan="1" colspan="1"
                                    style="width: 114.25px;"
                                    aria-label="Company Agent: activate to sort column ascending">مبلغ فاکتور
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="m_table_1" rowspan="1" colspan="1"
                                    style="width: 67.25px;" aria-label="Ship Date: activate to sort column ascending">
                                    مقدار مانده فاکتور
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="m_table_1" rowspan="1" colspan="1"
                                    style="width: 59.25px;" aria-label="Status: activate to sort column ascending">
                                    وضعیت فاکتور
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="m_table_1" rowspan="1" colspan="1"
                                    style="width: 36.25px;" aria-label="Type: activate to sort column ascending">سهم
                                    آرایشگر
                                </th>
                                <th class="sorting_disabled" rowspan="1" colspan="1" style="width: 73.5px;"
                                    aria-label="Actions">ویرایش
                                </th>
                            </tr>
                            </thead>
                            <tbody>
                            {% load jformat %}
                            {% for factor in factors %}
                                <tr>
                                    <td>{{ factor.code }}</td>
                                    <td>{{ factor.customer_factors.user.first_name }} {{ factor.customer_factors.user.last_name }}</td>
                                    <td>{{ factor.customer_factors.user.phone_number }}</td>
                                    <td>{{ factor.created_date|jformat:'%Y-%m-%d %H:%M:%S' }}</td>
                                    <td>{{ factor.final_amount }}</td>
                                    {% load subtract %}
                                    <td>{{ factor.final_amount|subtract:factor.paid_amount }}</td>
                                    <td>{{ factor.status }}</td>
                                    <td>20%</td>
                                    <td><a href="/update-factor/?code={{ factor.code }}"
                                           class="m-portlet__nav-link btn m-btn m-btn--hover-brand m-btn--icon m-btn--icon-only m-btn--pill"
                                           title="View"> <i class="la la-edit"></i> </a></td>
                                </tr>
                            {% endfor %}
                            </tbody>
                            <tfoot>
                            <tr>
                                <th rowspan="1" colspan="1">شماره فاکتور</th>
                                <th rowspan="1" colspan="1">نام مشتری</th>
                                <th rowspan="1" colspan="1">شماره همراه</th>
                                <th rowspan="1" colspan="1">تاریخ فاکتور</th>
                                <th rowspan="1" colspan="1">مبلغ فاکتور</th>
                                <th rowspan="1" colspan="1">مقدار مانده فاکتور</th>
                                <th rowspan="1" colspan="1">وضعیت فاکتور</th>
                                <th rowspan="1" colspan="1">سهم آرایشگر</th>
                                <th rowspan="1" colspan="1">ویرایش</th>
                            </tr>
                            </tfoot>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}
{% block footer %}
    {% csrf_token %}
    {% load static %}
    <script src="{% static 'ticket/js/datatables.bundle.js' %}" type="text/javascript"></script>
    <script>
    $(document).ready(function () {
        $('table').each(function (index, value) {
            $(this).DataTable()
        })
    });
    </script>
    {#    <script src="{% static 'ticket/js/advanced-search.js' %}" type="text/javascript"></script>#}
{% endblock %}